<!DOCTYPE html>
<!-- saved from url=(0047)https://sarangaranaweera.github.io/loading-app/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEB-V5</title>

    <style>
        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none !important;
            }
            .form-section {
                display: none !important;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 10px;
            line-height: 1.2;
            color: #000;
            background: #f5f5f5;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .form-section {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .form-section h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #FFFFFF;
            border-bottom: 2px solid #007acc;
            padding-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            font-weight: bold;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 12px;
            color: #FFFFFF;
        }

        .black-clr {
            color: #101010;
            text-shadow: 0 1px 3px rgba(0,0,0,0.7);
        }

        .form-group input, .form-group select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007acc;
            box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.3);
            background: rgba(255, 255, 255, 1);
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .autocomplete-suggestions.show {
            display: block;
        }

        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            font-size: 12px;
        }

        .autocomplete-item:hover {
            background: #f0f8ff;
        }

        .line-items-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .line-item-form {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 10px;
            align-items: end;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }

        .btn-primary {
            background: #007acc;
            color: white;
        }

        .btn-primary-2 {
            background: #007acc;
            color: white;
            font-size: 10px;
            padding: 5px 8px;
            text-align: right;
            float: right;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .line-items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 11px;
        }

        .line-items-table th,
        .line-items-table td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .line-items-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .line-items-table .text-right {
            text-align: right;
        }

        .grand-total {
            font-size: 14px;
            font-weight: bold;
            background: #e9ecef;
        }

        .container {
            max-width: 210mm;
            margin: 20px auto;
            padding: 10px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            display: flex;
            align-items: center;
            border: 2px solid #000;
            margin-bottom: 2px;
        }

        .logo-section {
            width: 60px;
            border-right: 2px solid #000;
            padding: 5px;
            text-align: center;
        }

        .logo {
            width: 40px;
            height: 40px;
            border: 1px solid #000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 8px;
            background: #f0f0f0;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .title-section {
            flex: 1;
            padding: 10px;
            text-align: center;
        }

        .main-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 2px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 10px;
        }

        .office-info {
            width: 150px;
            border-left: 2px solid #000;
            padding: 10px;
            text-align: center;
        }

        .office-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .info-section {
            display: flex;
            border: 2px solid #000;
            border-top: none;
            margin-bottom: 2px;
        }

        .info-left {
            flex: 1;
            border-right: 1px solid #000;
        }

        .info-right {
            width: 150px;
        }

        .info-row {
            display: flex;
            border-bottom: 1px solid #000;
            min-height: 25px;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            width: 120px;
            padding: 5px 8px;
            border-right: 1px solid #000;
            background: #f8f8f8;
        }

        .info-value {
            flex: 1;
            padding: 5px 8px;
        }

        .table-container {
            border: 2px solid #000;
            margin-bottom: 2px;
        }

        .table-header {
            display: flex;
            background: #f0f0f0;
            border-bottom: 2px solid #000;
            font-weight: bold;
            text-align: center;
        }

        .col-sn { width: 60px; text-align: left; }
        .col-description { flex: 1; }
        .col-unit { width: 40px; }
        .col-rate { width: 50px; }
        .col-qty { width: 30px; }
        .col-amount { width: 70px; }
        .col-cert-qty { width: 50px; }
        .col-cert-amount { width: 150px; }

        .col-font {
            font-
        }

        .table-header > div {
            padding: 8px 4px;
            border-right: 1px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .table-header > div:last-child {
            border-right: none;
        }

        .table-row {
            display: flex;
            border-bottom: 1px solid #000;
            min-height: 20px;
        }

        .table-row:last-child {
            border-bottom: none;
        }

        .table-row > div {
            padding: 3px 4px;
            border-right: 1px solid #000;
            font-size: 9px;
        }

        .table-row > div:last-child {
            border-right: none;
        }

        .summary-section {
            border: 2px solid #000;
            border-top: none;
            min-height: 60px;
        }

        .summary-text {
            padding: 10px;
            text-align: center;
            font-size: 12px;
            line-height: 1.4;
        }

        .signature-section {
            display: flex;
            border: 2px solid #000;
            border-top: none;
            margin-bottom: 2px;
        }

        .signature-left {
            flex: 1;
            border-right: 1px solid #000;
            padding: 10px;
        }

        .signature-right {
            width: 400px;
            padding: 10px;
        }

        .signature-row {
            margin-bottom: 15px;
        }

        .signature-label {
            font-size: 9px;
            margin-bottom: 20px;
        }

        .signature-line {
            border-bottom: 1px solid #000;
            height: 1px;
            margin-bottom: 5px;
        }

        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 8px;
            margin-top: 10px;
        }

        .controls {
            text-align: center;
            margin: 20px 0;
        }

        .status-indicator {
            font-size: 11px;
            color: #666;
            padding: 5px 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }

        .save-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .save-notification.show {
            opacity: 1;
        }

        /* Night Sky Background Styles */
        .night-sky-background {
            position: relative;
            overflow: hidden;
            background: linear-gradient(to bottom, #0B1426 0%, #1a1a2e 50%, #16213e 100%);
            min-height: auto;
            height: auto;
        }

        .night-sky-background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                /* Night sky gradient */
                linear-gradient(to bottom, #0B1426 0%, #1a1a2e 50%, #16213e 100%),
                /* Subtle star field */
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 90% 30%, rgba(255,255,255,0.05) 0%, transparent 40%),
                radial-gradient(circle at 50% 60%, rgba(255,255,255,0.08) 0%, transparent 45%);
            z-index: 1;
        }



        /* Moon */
        .moon {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 45px;
            background: radial-gradient(circle, #F5F5DC 0%, #E6E6FA 50%, #D3D3D3 100%);
            border-radius: 50%;
            z-index: 2;
            box-shadow: 0 0 20px rgba(245, 245, 220, 0.5);
            animation: moonrise 1800s linear infinite;
        }

        /* Moon Glow Effect */
        .moon::after {
            content: '';
            position: absolute;
            top: -15px;
            left: -15px;
            width: 75px;
            height: 75px;
            background: radial-gradient(circle, rgba(255, 255, 200, 0.3) 0%, rgba(255, 255, 200, 0.1) 50%, transparent 70%);
            border-radius: 50%;
            z-index: 1;
            animation: moonGlow 4s ease-in-out infinite;
            opacity: 0;
        }

        .moon::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 12px;
            width: 10px;
            height: 10px;
            background: rgba(200, 200, 200, 0.6);
            border-radius: 50%;
        }

        /* Stars */
        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #FFFFFF;
            border-radius: 50%;
            z-index: 2;
            animation: starTwinkle 3s ease-in-out infinite;
        }

        .star-1 { top: 20px; left: 15%; animation-delay: 0s; }
        .star-2 { top: 35px; left: 25%; animation-delay: 0.5s; }
        .star-3 { top: 15px; left: 40%; animation-delay: 1s; }
        .star-4 { top: 45px; left: 55%; animation-delay: 1.5s; }
        .star-5 { top: 25px; left: 70%; animation-delay: 2s; }
        .star-6 { top: 40px; left: 85%; animation-delay: 2.5s; }
        .star-7 { top: 30px; left: 10%; animation-delay: 0.3s; }
        .star-8 { top: 50px; left: 30%; animation-delay: 0.8s; }
        .star-9 { top: 18px; left: 45%; animation-delay: 1.3s; }
        .star-10 { top: 38px; left: 60%; animation-delay: 1.8s; }
        .star-11 { top: 28px; left: 75%; animation-delay: 2.3s; }
        .star-12 { top: 42px; left: 90%; animation-delay: 0.7s; }
        .star-13 { top: 22px; left: 20%; animation-delay: 1.2s; }
        .star-14 { top: 48px; left: 35%; animation-delay: 1.7s; }
        .star-15 { top: 32px; left: 50%; animation-delay: 2.2s; }

        /* Asteroids */


        /* Moonrise Animation */
        @keyframes moonrise {
            0% {
                top: 100%;
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }
            5% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            45% {
                top: 50%;
                transform: translateX(-50%) scale(1.2);
            }
            50% {
                top: 45%;
                transform: translateX(-50%) scale(1.1);
            }
            95% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            100% {
                top: -10%;
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }
        }

        /* Moon Glow Animation */
        @keyframes moonGlow {
            0%, 100% {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        /* Ensure form content is above background */
        .form-section > * {
            position: relative;
            z-index: 3;
        }

        @media screen and (max-width: 800px) {
            .line-item-form {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container" x-data="invoiceApp()" x-init="init()">
        
        <!-- Form Section -->
        <div class="form-section no-print night-sky-background">
          <a class="weatherwidget-io" href="https://forecast7.com/en/5d9580d55/matara/" data-label_1="MATARA" data-label_2="WEATHER" data-days="3" data-theme="dark" >MATARA WEATHER</a>
<script>
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
</script>
            <!-- Night Sky Elements -->
            <div class="moon"></div>
            
            <div class="star star-1"></div>
            <div class="star star-2"></div>
            <div class="star star-3"></div>
            <div class="star star-4"></div>
            <div class="star star-5"></div>
            <div class="star star-6"></div>
            <div class="star star-7"></div>
            <div class="star star-8"></div>
            <div class="star star-9"></div>
            <div class="star star-10"></div>
            <div class="star star-11"></div>
            <div class="star star-12"></div>
            <div class="star star-13"></div>
            <div class="star star-14"></div>
            <div class="star star-15"></div>
            
            <div class="asteroid asteroid-1"></div>
            <div class="asteroid asteroid-2"></div>
            <div class="asteroid asteroid-3"></div>
            <div class="asteroid asteroid-4"></div>
            <div class="asteroid asteroid-5"></div>
            <div class="asteroid asteroid-6"></div>
            <div class="asteroid asteroid-7"></div>
            <div class="asteroid asteroid-8"></div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h2><img width="45px" height="40px" src="./ceblogo.PNG" /> Contractor Billing System</h2>
                <div style="font-size: 11px; color: #FFFFFF; text-shadow: 0 1px 2px rgba(0,0,0,0.7);">
                    <button type="button" style="margin-right: 25px; " class="btn btn-primary" @click="clearInvoice()">
                        ‚ûï New Invoice
                     </button>
                     <a href="./summary.html" target="_blank" class="btn btn-primary" style="text-decoration: none;">
                        üßæSummary Bill
                     </a>
                </div>
            </div>
                         <div class="form-row">
                 <div class="form-group">
                     <label>Contractor Name</label>
                     <input type="text" x-model="invoiceData.contractorName" @input="saveToStorage()" placeholder="Enter contractor name">
                 </div>
                 <div class="form-group">
                     <label>Job Name</label>
                     <input type="text" x-model="invoiceData.location" @input="saveToStorage()" placeholder="Enter location">
                 </div>
                 <div class="form-group">
                     <label>Job Number</label>
                     <input type="text" x-model="invoiceData.serviceNumber" @input="saveToStorage()" placeholder="Enter service number">
                 </div>
                 <div class="form-group">
                     <label>Completed Date</label>
                     <input type="date" x-model="invoiceData.reportDate" @input="saveToStorage()">
                 </div>
             </div>
        </div>

        <!-- Line Items Section -->
        <div class="line-items-section no-print">

            <h2>Line Items</h2>
            
            <!-- Add Line Item Form -->
            <div class="line-item-form">
                <div class="form-group" >
                    <label style="color: #101010;">Description</label>
                    <div class="autocomplete-container">
                        <input type="text" x-model="currentItem.ino" @input="showSuggestions = true; console.log('Input changed:', currentItem.ino)" @blur="setTimeout(() =&gt; showSuggestions = false, 200)" placeholder="Start typing description...">
                        <div style="font-size: 10px; color: #666; margin-top: 2px;" x-show="showSuggestions">
                        </div>
                        <div class="autocomplete-suggestions" :class="{ &#39;show&#39;: showSuggestions &amp;&amp; filteredSuggestions.length &gt; 0 }">
                            <template x-for="suggestion in filteredSuggestions" :key="suggestion.ino">
                                <div class="autocomplete-item" @click="selectSuggestion(suggestion)">
                                    <div style="font-weight: bold; color: #007acc;" x-text="suggestion.ino"></div>
                                    <div x-text="suggestion.description"></div>
                                    <small style="color: #666;">Rate: Rs. <span x-text="suggestion.rate"></span> | Unit: <span x-text="suggestion.unit"></span></small>
                                </div>
                            </template>
                            <div x-show="showSuggestions && filteredSuggestions.length === 0" style="padding: 10px; color: #666; font-style: italic;">
                                No suggestions found
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label style="color: #101010;">Rate (Rs.)</label>
                    <input type="number" readonly x-model.number="currentItem.rate" @input="calculateAmount()" step="0.01" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label style="color: #101010;">Quantity</label>
                    <input type="number" step="1" min="0" max="1000" x-model.number="currentItem.quantity" @input="calculateAmount()" step="0.01" placeholder="0">
                </div>
                <div class="form-group">
                    <label style="color: #101010;">Amount (Rs.)</label>
                    <input type="number" min="0" max="1000000" x-model.number="currentItem.amount" readonly="" style="background: #f8f9fa;">
                </div>
                <div class="form-group">
                    <button type="button" class="btn btn-primary" @click="addLineItem()" :disabled="!canAddItem()" disabled="disabled">
                        Add Item
                    </button>
                </div>
            </div>

            <!-- Line Items Table -->
            <table class="line-items-table" x-show="lineItems.length &gt; 0" style="display: none;">
                <thead>
                    <tr>
                        <th style="width: 50px;">I/No</th>
                        <th>Description</th>
                        <th style="width: 60px;">Unit</th>
                        <th style="width: 80px;">Rate (Rs.)</th>
                        <th style="width: 80px;">Qty.</th>
                        <th style="width: 150px;">Amount (Rs.)</th>
                        <th style="width: 80px;" class="no-print">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="(item, index) in lineItems" :key="index">
                        <tr>
                            <td x-text="item.ino"></td>
                            <td x-text="item.description"></td>
                            <td x-text="item.unit"></td>
                            <td class="text-right" x-text=" parseFloat(item.rate).toFixed(2)"></td>
                            <td class="text-right" x-text="parseFloat(item.quantity).toFixed(2)"></td>
                            <td class="text-right" x-text="parseFloat(item.amount).toFixed(2)"></td>
                            <td class="no-print">
                                <button type="button" class="btn btn-danger" @click="removeLineItem(index)" style="padding: 4px 8px; font-size: 10px;">Delete</button>
                            </td>
                        </tr>
                    </template>
                    <tr class="grand-total">
                        <td colspan="5" style="text-align: right; font-weight: bold;">Grand Total:</td>
                        <td class="text-right" style="font-weight: bold;" x-text="grandTotal.toFixed(2)">Rs. 0.00</td>
                        <td class="no-print"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Print Controls -->
        <div class="controls no-print">
            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; align-items: center;">
                <button type="button" class="btn btn-success" @click="printInvoice()" :disabled="lineItems.length === 0" disabled="disabled">
                    <span style="font-size: 15px;">üñ®Ô∏è</span> Print</span>
                </button>


            </div>
        </div>

        <!-- Invoice Template -->
        <div class="container">
            <!-- Header Section -->
            <div class="header">
                <div class="logo-section">
                    <div class="logo" style="background-image: url('./ceblogo.PNG');"></div>
                </div>
                <div class="title-section">
                    <div class="main-title">CONTRACTOR INVOICE</div>
                </div>
                                 <div class="office-info">
                     <div class="office-title">Ceylon Electricity Board</div>
                     <div x-text="invoiceData.officeName">CSC - Matara</div>
                 </div>
            </div>

            <!-- Information Section -->
            <div class="info-section">
                <div class="info-left">
                    <div class="info-row">
                        <div class="info-label">Contractor Name :</div>
                        <div class="info-value" x-text="invoiceData.contractorName"></div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Job Name :</div>
                        <div class="info-value" x-text="invoiceData.location"></div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Job Number :</div>
                        <div class="info-value" x-text="invoiceData.serviceNumber"></div>
                    </div>
                </div>
                <div class="info-right">
                    <div class="info-row">
                        <div class="info-value" ></div>
                    </div>
                    <div class="info-row">
                        <div class="info-value"></div>
                    </div>
                    <div class="info-row">
                        <div class="info-label" style="width: 80px;">Completed Date :</div>
                        <div class="info-value" x-text="formatDate(invoiceData.reportDate)"></div>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="table-container">
                <div class="table-header">
                    <div class="col-sn">I/No</div>
                    <div class="col-description">Description</div>
                    <div class="col-rate">Rate<br>(Rs.)</div>
                    <div class="col-qty">Qty.</div>
                    <div class="col-amount">Amount<br>(Rs.)</div>
                    <div class="col-cert-qty">Certified<br>Qty.</div>
                    <div class="col-cert-amount">Amount (Rs.)</div>
                </div>

                <!-- Dynamic Table Rows -->
                <template x-for="(item, index) in printableRows" :key="index">
                    <div class="table-row">
                        <div class="col-sn" x-text="item.ino"></div>
                        <div class="col-description" x-text="item.description"></div>
                        <div class="col-rate" style="text-align: right;" x-text="item.rate"></div>
                        <div class="col-qty" x-text="item.quantity"></div>
                        <div class="col-amount" style="text-align: right;" x-text="item.amount"></div>
                        <div class="col-cert-qty" x-text="item.certifiedQty"></div>
                        <div class="col-cert-amount" x-text="item.certifiedAmount"></div>
                    </div>
                </template>
                
                <!-- Total Row -->
                <div class="table-row" style="background: #f0f0f0; font-weight: bold; border-top: 2px solid #000;">
                    <div class="col-sn"></div>
                    <div class="col-description" style="text-align: center;">TOTAL</div>
                    <div class="col-rate"></div>
                    <div class="col-qty"></div>
                    <div class="col-amount" style="text-align: right;" x-text="grandTotal.toFixed(2)">0.00</div>
                    <div class="col-cert-qty"></div>
                    <div class="col-cert-amount" ></div>
                </div>
            </div>

            <!-- Summary Section -->
            <div class="summary-section">
                <div class="summary-text">
                    The above electrical lines have been completed in accordance with C.E.B standards.
                    <br>
                    I request you to pay the amount as per the above invoice.
                </div>
            </div>

            <!-- Signature Section -->
            <div class="signature-section">
                <div class="signature-left">
                    <div class="signature-row">
                        <div class="signature-label">Contractor</div>
                        <div class="signature-line"></div>
                    </div>
                    <div class="signature-row">
                        <div class="signature-label">C.E.B Linesmen</div>
                        <div class="signature-line"></div>
                    </div>
                    <div class="signature-row">
                        <div class="signature-label">E.S. (C.S.C)</div>
                        <div class="signature-line"></div>
                    </div>
                </div>
                <div class="signature-right">
                    <div class="signature-row">
                        <div class="signature-label">Office E.S</div>
                        <div class="signature-line"></div>
                    </div>
                    <div class="signature-row">
                        <div class="signature-label"></div>

                    </div>
                    <div class="signature-row">
                        <div class="signature-label">Area Cheaf Engineer</div>
                        <div class="signature-line"></div>
                    </div>
                </div>
            </div>


        </div>
    </div>

<!-- Alpine.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.3/cdn.min.js" defer></script>
<script>
let jsondata = [];

function loadJson(){
    return { async init() {
            // Load JSON data from file
            const response = await fetch('./item.json');
            const data = await response.json();
            this.jsondata = data;
        }
    }

}

function invoiceApp(){
    return {
        invoiceData: {
             contractorName: "",
             location: "",
             serviceNumber: "",
             reportDate: (new Date).toISOString().split("T")[0],
             officeName: "CSC - Matara"
         },
        currentItem: {
            ino: "",
            description: "",
            unit: "Nos",
            rate: 0,
            quantity: 0,
            amount: 0
        },
        lineItems: [],
        showSuggestions: false,
        showSaveNotification: false,
        serviceDescriptions: [
  {
    ino: "0",
    description: "0",
    unit: "0",
    rate: "1.00"
  },
  {
    ino: "01",
    description: "Transportation of poles",
    unit: "Km",
    rate: "1970.00"
  },
  {
    ino: "01.1",
    description: "8.3m /9m RC pole",
    unit: "No",
    rate: "83.00"
  },
  {
    ino: "01.2",
    description: "6m RC pole",
    unit: "No",
    rate: "43.00"
  },
  {
    ino: "01.3",
    description: "Wooden pole ",
    unit: "No",
    rate: "45.00"
  },
  {
    ino: "33",
    description: "dfdsfdf",
    unit: "no",
    rate: "6.00"
  },
  {
    ino: "777",
    description: "sdfd dfd fds df ",
    unit: "rt",
    rate: "700.00"
  },
  {
    ino: "A 1",
    description: "Excavation of pole pits ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 1.1",
    description: "For LT poles 8.3m / 9.0m",
    unit: "No",
    rate: "744.00"
  },
  {
    ino: "A 1.2",
    description: "2.5'' x2'' x5 1/2(9/350 poles)",
    unit: "No",
    rate: "837.00"
  },
  {
    ino: "A 1.3",
    description: "2.5'' x2'' x5 1/2'' (8.3m/9.0m 500kg poles)",
    unit: "No",
    rate: "837.00"
  },
  {
    ino: "A 10",
    description: "Erection of Stays",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 10.1",
    description: "Normal stay",
    unit: "No",
    rate: "744.00"
  },
  {
    ino: "A 10.2",
    description: "Fly stay - considered as 1.5 times normal stay ",
    unit: "No",
    rate: "1116.00"
  },
  {
    ino: "A 11",
    description: "Dressing of LV pole",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 11.1",
    description: "1 phase pole ",
    unit: "No",
    rate: "167.00"
  },
  {
    ino: "A 11.2",
    description: "3 phase pole",
    unit: "No",
    rate: "223.00"
  },
  {
    ino: "A 11.3",
    description: "1 Ph.to 3 Ph.Conversion",
    unit: "No",
    rate: "167.00"
  },
  {
    ino: "A 11.4",
    description: "2 ph to.3 ph Conversion ",
    unit: "No",
    rate: "112.00"
  },
  {
    ino: "A 12",
    description: "Stringing of AAC conductors",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 12.1",
    description: "AAC 7/3.4mm per one conductor per km",
    unit: "No",
    rate: "11160.00"
  },
  {
    ino: "A 12.2",
    description: "AAC 7/4.39mm (Wasp) per one conductor per km",
    unit: "No",
    rate: "13020.00"
  },
  {
    ino: "A 12.3",
    description: "ABC conductors (Inclusive of dressing of poles)",
    unit: "No",
    rate: "16.70"
  },
  {
    ino: "A 13",
    description: "Removal & reconnecting of service wire",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 13.1",
    description: "Single phase service",
    unit: "No",
    rate: "74.00"
  },
  {
    ino: "A 13.2",
    description: "Three phase service",
    unit: "No",
    rate: "130.00"
  },
  {
    ino: "A 14",
    description: "Earthing",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 14.1",
    description: "Stringing of No 8 GS wire",
    unit: "No",
    rate: "8928.00"
  },
  {
    ino: "A 14.2",
    description: "Erection of earth pipes down run & making connection",
    unit: "No",
    rate: "335.00"
  },
  {
    ino: "A 15",
    description: "Extra payments",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 15.1",
    description: "For jobs with line length less than 500m",
    unit: "No",
    rate: "2225.00"
  },
  {
    ino: "A 15.2 ",
    description: "For jobs with line length more than 500m but less than ",
    unit: "No",
    rate: "1965.00"
  },
  {
    ino: "A 15.3",
    description: "Cost of minor way leaves cleaning per km",
    unit: "No",
    rate: "1900.00"
  },
  {
    ino: "A 16",
    description: "Removal and reconnecting of service wire ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 16.1 ",
    description: "Single phase service",
    unit: "No",
    rate: "84.00"
  },
  {
    ino: "A 16.2",
    description: "Three phase service",
    unit: "No",
    rate: "146.00"
  },
  {
    ino: "A 17",
    description: "Changing of service wire with new wire",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 17.1",
    description: "Length of service below 30m",
    unit: "No",
    rate: "752.00"
  },
  {
    ino: "A 17.2",
    description: "Length of service above 30m",
    unit: "No",
    rate: "940.00"
  },
  {
    ino: "A 18",
    description: "Rehabilitation of existing service",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 18.1 ",
    description: "Length of service below 30m",
    unit: "No",
    rate: "439.00"
  },
  {
    ino: "A 18.2",
    description: "Length of service above 30m",
    unit: "No",
    rate: "711.00"
  },
  {
    ino: "A 19",
    description: "Replacing of poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 19.1 ",
    description: "Replacing of 6m/6.7m wd pole or Con pole with same size wd pole",
    unit: "No",
    rate: "1881.00"
  },
  {
    ino: "A 19.2",
    description: "Replacing of 6m/6.7m wd pole or con pole with same size con pole ",
    unit: "No",
    rate: "3000.00"
  },
  {
    ino: "A 19.3",
    description: "Replacing of 8.3m/9m wd pole or con pole with same size wd pole ",
    unit: "No",
    rate: "2926.00"
  },
  {
    ino: "A 19.4",
    description: "Replacing of 8.3m/9m wd pole or con pole with same size con pole ",
    unit: "No",
    rate: "3135.00"
  },
  {
    ino: "A 2 ",
    description: "Excavation of pits for struts",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 2.1",
    description: "2.5'' x2'' x2'' (For LT poles)",
    unit: "No",
    rate: "372.00"
  },
  {
    ino: "A 20",
    description: "Minor way leaves",
    unit: "No",
    rate: "950.00"
  },
  {
    ino: "A 3",
    description: "Excavation of pits for stays",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 3.1 ",
    description: "2.5' x 2'  x 5'  (For LT stay)",
    unit: "No",
    rate: "744.00"
  },
  {
    ino: "A 4",
    description: "Dragging of poles (First 100m distance shall not be paid)",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 4.1",
    description: "8.3/9m Wood pole - Flat ground",
    unit: "No",
    rate: "37.00"
  },
  {
    ino: "A 4.2",
    description: "8.3/9m Wood pole - Up slope (>15 inclination)",
    unit: "No",
    rate: "56.00"
  },
  {
    ino: "A 4.3",
    description: "8.3/9m RC pole - Flat ground",
    unit: "No",
    rate: "74.00"
  },
  {
    ino: "A 4.4",
    description: "8.3/9m RC pole - Up slope (>15 inclination)",
    unit: "No",
    rate: "149.00"
  },
  {
    ino: "A 5",
    description: "Erection of poles",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 5.1",
    description: "9m/8.3m Wood pole",
    unit: "No",
    rate: "670.00"
  },
  {
    ino: "A 5.2",
    description: "9m/8.3m Concrete pole",
    unit: "No",
    rate: "1507.00"
  },
  {
    ino: "A 5.3",
    description: "9/350m Concrete pole",
    unit: "No",
    rate: "1674.00"
  },
  {
    ino: "A 5.4",
    description: "9/500m Concrete pole",
    unit: "No",
    rate: "1674.00"
  },
  {
    ino: "A 6",
    description: "Removal of poles/struts ",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 6.1",
    description: "8.3/9m 500kg P.S",
    unit: "No",
    rate: "1488.00"
  },
  {
    ino: "A 7",
    description: "Concreting of pole pits",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 7.1",
    description: "9m/8.3m Concrete pole (loose soil condition only",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "A 7.1 A",
    description: "Charge for materials",
    unit: "No",
    rate: "5458.00"
  },
  {
    ino: "A 7.1 B",
    description: "Labour charge for placing concrete ",
    unit: "No",
    rate: "744.00"
  },
  {
    ino: "A 7.2",
    description: "Concreting of pole pits 9/350kg and 9/500",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 7.2 A",
    description: "Charge for materials ",
    unit: "No",
    rate: "5933.00"
  },
  {
    ino: "A 7.2 B",
    description: "Labour charge for placing concrete ",
    unit: "No",
    rate: "837.00"
  },
  {
    ino: "A 8",
    description: "Re- Tensioning of conductor of existing lines ",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "A 8.1",
    description: "7/3.4mm, 7/4.39mm All aluminium conductors",
    unit: "No",
    rate: "8370.00"
  },
  {
    ino: "A 8.2",
    description: "ABC",
    unit: "No",
    rate: "11904.00"
  },
  {
    ino: "A 9.1",
    description: "9m/8.3m Wood pole",
    unit: "No",
    rate: "744.00"
  },
  {
    ino: "A 9.2",
    description: "9m/8.3m Concrete pole",
    unit: "No",
    rate: "1674.00"
  },
  {
    ino: "A9",
    description: "Erection of Struts",
    unit: "",
    rate: "0.00"
  },
  {
    ino: "RA  21",
    description: "Replacing of poles ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 1",
    description: "Excavation of pole pits",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 1.1",
    description: "(For service poles) 6m/6.7m -2.5",
    unit: "No",
    rate: "1800.00"
  },
  {
    ino: "RA 1.2",
    description: "(For LT poles 8.3m/9m) 4+0.5",
    unit: "No",
    rate: "3230.00"
  },
  {
    ino: "RA 1.3",
    description: "(9/350 poles) 4.5+0.5",
    unit: "No",
    rate: "3590.00"
  },
  {
    ino: "RA 1.4",
    description: "(9/500 poles) 4.5+0.5",
    unit: "No",
    rate: "1800.00"
  },
  {
    ino: "RA 10",
    description: "Dressing of LV pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 10.1",
    description: "6.0m/6.7m Wooden pole",
    unit: "No",
    rate: "1720.00"
  },
  {
    ino: "RA 10.2",
    description: "6.0m/6.7m concrete Pole",
    unit: "No",
    rate: "2300.00"
  },
  {
    ino: "RA 10.3",
    description: "9m/8.3m Wooden Pole",
    unit: "No",
    rate: "3230.00"
  },
  {
    ino: "RA 10.4",
    description: "9m/8.3m concrete pole",
    unit: "No",
    rate: "7900.00"
  },
  {
    ino: "RA 10.5",
    description: "Fixing of Strut  Brackets for existing Struts",
    unit: "No",
    rate: "720.00"
  },
  {
    ino: "RA 11",
    description: "Removal of hardware from Existing LV poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 11.1 ",
    description: "Normal Stay (LV Stay)",
    unit: "No",
    rate: "3230.00"
  },
  {
    ino: "RA 11.2",
    description: "times normal stay",
    unit: "No",
    rate: "4670.00"
  },
  {
    ino: "RA 11.3",
    description: "Repairing of LV stay",
    unit: "No",
    rate: "1080.00"
  },
  {
    ino: "RA 11.4",
    description: "Retightening of LV stay",
    unit: "No",
    rate: "360.00"
  },
  {
    ino: "RA 11.5",
    description: "Relocating of LV stay",
    unit: "No",
    rate: "2870.00"
  },
  {
    ino: "RA 12",
    description: "Stringing of AAC conductors",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 12.1",
    description: "1 phase pole (average rate for shackle & intermediate poles)",
    unit: "No",
    rate: "650.00"
  },
  {
    ino: "RA 12.2",
    description: "3 phase  pole",
    unit: "No",
    rate: "860.00"
  },
  {
    ino: "RA 12.3",
    description: "1 ph -3ph conversion ",
    unit: "No",
    rate: "650.00"
  },
  {
    ino: "RA 12.4",
    description: "2 ph -3ph conversion  (-do-) allowed half rate of 1ph -3ph",
    unit: "No",
    rate: "430.00"
  },
  {
    ino: "RA 12.5",
    description: "1 ph tapping pole",
    unit: "No",
    rate: "720.00"
  },
  {
    ino: "RA 12.6",
    description: "2 ph tapping pole ",
    unit: "No",
    rate: "860.00"
  },
  {
    ino: "RA 12.7",
    description: "3 ph tapping pole",
    unit: "No",
    rate: "1080.00"
  },
  {
    ino: "RA 12.8",
    description: "fixing of LV brackets ",
    unit: "No",
    rate: "1440.00"
  },
  {
    ino: "RA 12.9",
    description: "fixing of bunddle conductor accessories ,suspension/large angle/dead end assembly",
    unit: "No",
    rate: "430.00"
  },
  {
    ino: "RA 13",
    description: "Removal of conductors ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 13.1",
    description: "single phase",
    unit: "No",
    rate: "860.00"
  },
  {
    ino: "RA 13.2",
    description: "Three phase",
    unit: "No",
    rate: "1290.00"
  },
  {
    ino: "RA 13.3 ",
    description: "Removal of street lamp(complete set)",
    unit: "NO",
    rate: "860.00"
  },
  {
    ino: "RA 13.4",
    description: "Installation of street lamp (complete set)",
    unit: "NO",
    rate: "930.00"
  },
  {
    ino: "RA 14",
    description: "Re-Tensioning of Conductors on Existing lines ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 14.1",
    description: "AAC 7/3.4mm (fly) per one conductor per km",
    unit: "No",
    rate: "43080.00"
  },
  {
    ino: "RA 14.2",
    description: "AAC 7/4mm (wasp) per one conductor per km",
    unit: "No",
    rate: "50260.00"
  },
  {
    ino: "RA 14.3",
    description: "ABC 50X1+54.6X1 or 70x1+54.6x1 conductors ( inclusive of dressing of pole) per km",
    unit: "No",
    rate: "86160.00"
  },
  {
    ino: "RA 14.4",
    description: "ABC 70X3+54 6X1+16X1 conductors (4 or 5 cores)-(inclusive of dressing of poles)per km",
    unit: "No",
    rate: "143600.00"
  },
  {
    ino: "RA 14.5",
    description: "ABC 95X3+70X1+16X1 Conductors (4 or 5 cores)-(inclusive of dressing of poles)per km",
    unit: "No",
    rate: "157960.00"
  },
  {
    ino: "RA 15",
    description: "Concreting of pole pits",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 15.1",
    description: "7/3.79mm,7/3.4mm All Aluminium (per conductor)",
    unit: "No",
    rate: "19390.00"
  },
  {
    ino: "RA 15.1 a",
    description: "Charge for materials",
    unit: "No",
    rate: "5458.00"
  },
  {
    ino: "RA 15.1 b",
    description: "7/3.79mm,7/3.4mm All Aluminium (per conductor)",
    unit: "No",
    rate: "19390.00"
  },
  {
    ino: "RA 15.2",
    description: "ABC 70X3+54 6X1+16X1 conductors (4 or 5 cores)-(inclusive of dressing of poles)per km",
    unit: "No",
    rate: "19390.00"
  },
  {
    ino: "RA 15.2 a",
    description: "Charge for materials ",
    unit: "No",
    rate: "5933.00"
  },
  {
    ino: "RA 15.2 b",
    description: "Labour charge for  placing concrete 4.5+0.5",
    unit: "No",
    rate: "1045.00"
  },
  {
    ino: "RA 16",
    description: "Re - tensioning of conductors on existing lines ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 16.1",
    description: "7/34mm7/4.39mm All Aluminium conductors (per conductor)",
    unit: "No",
    rate: "32310.00"
  },
  {
    ino: "RA 16.2",
    description: "ABC 50X1+54.6X1 or 70x1+54.6x1 conductors ( inclusive of dressing of pole) per km",
    unit: "No",
    rate: "27280.00"
  },
  {
    ino: "RA 16.3 ",
    description: "ABC 70X3+54 6X1+16X1 conductors (4 or 5 cores)-(inclusive of dressing of poles)per km",
    unit: "No",
    rate: "45950.00"
  },
  {
    ino: "RA 16.4",
    description: "ABC 95X3+70X1+16X1 Conductors (4 or 5 cores)-(inclusive of dressing of poles)per km",
    unit: "No",
    rate: "47390.00"
  },
  {
    ino: "RA 17",
    description: "Conctreting  of pole pits",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 17.1",
    description: "Length of service below 30m",
    unit: "No",
    rate: "752.00"
  },
  {
    ino: "RA 17.1.1",
    description: "8.3m/9m RC pole  charge for materials ",
    unit: "No",
    rate: "9050.00"
  },
  {
    ino: "RA 17.1.2",
    description: "8.3m/9m RC pole labour charge for placing concrete",
    unit: "No",
    rate: "3590.00"
  },
  {
    ino: "RA 17.2",
    description: "Length of service above 30m",
    unit: "No",
    rate: "940.00"
  },
  {
    ino: "RA 18",
    description: "Removal and reconnecting of service wire",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 18.1",
    description: "single phase service ",
    unit: "No",
    rate: "290.00"
  },
  {
    ino: "RA 18.2",
    description: "three phase service",
    unit: "No",
    rate: "500.00"
  },
  {
    ino: "RA 18.3",
    description: "single phase service",
    unit: "No",
    rate: "570.00"
  },
  {
    ino: "RA 18.4",
    description: "Three phase service",
    unit: "No",
    rate: "1010.00"
  },
  {
    ino: "RA 18.5",
    description: "spur line ",
    unit: "No",
    rate: "1220.00"
  },
  {
    ino: "RA 19",
    description: "Changing of service wire with new wire (per service)",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 19.1",
    description: "a.Single phase - first span  ",
    unit: "No",
    rate: "2580.00"
  },
  {
    ino: "RA 19.2",
    description: "Replacing of 6m/6.7m wood pole or Concrete pole with same size concrete pole",
    unit: "No",
    rate: "2090.00"
  },
  {
    ino: "RA 19.2.a",
    description: "Three phase first span ",
    unit: "No",
    rate: "3950.00"
  },
  {
    ino: "RA 19.3",
    description: "Replacing of 8.3m/9m wood pole or Concrete pole with same size wooden pole",
    unit: "No",
    rate: "2926.00"
  },
  {
    ino: "RA 19.4",
    description: "Replacing of 8.3m/9m wood pole or Concrete pole with same size concrete pole",
    unit: "No",
    rate: "3135.00"
  },
  {
    ino: "RA 2",
    description: "Excavation of pits for struts",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 2.1",
    description: "(For LT & service poles) 2",
    unit: "No",
    rate: "1440.00"
  },
  {
    ino: "RA 20 ",
    description: "Rehabilitation of existing services ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 20.1",
    description: " Length of service bellow 30m",
    unit: "No",
    rate: "1510.00"
  },
  {
    ino: "RA 20.2",
    description: "Length of service above 30m",
    unit: "No",
    rate: "2440.00"
  },
  {
    ino: "RA 20.3",
    description: "Removing from tapping point,crimp and refix the ",
    unit: "No",
    rate: "720.00"
  },
  {
    ino: "RA 21.1",
    description: "Replacing of 6.0m/6.7m wood pole or concrete pole with same size wooden pole ",
    unit: "No",
    rate: "6460.00"
  },
  {
    ino: "RA 21.2",
    description: "Replacing of 6.0m/6.7m wood pole or concrete pole with same size concrete pole",
    unit: "No",
    rate: "7180.00"
  },
  {
    ino: "RA 21.3",
    description: "Replacing f 8.3m/9.0m wood pole or concrete pole with same size wooden pole",
    unit: "No",
    rate: "10050.00"
  },
  {
    ino: "RA 21.4",
    description: "Replacing of 8.3m/9.0m wood pole or concrete pole with same size concrete pole",
    unit: "No",
    rate: "10770.00"
  },
  {
    ino: "RA 22.1",
    description: "shifting meter to another location using same service bracket - single phase",
    unit: "No",
    rate: "2150.00"
  },
  {
    ino: "RA 22.2",
    description: "shifting meter to another location using same service bracket -  three phase",
    unit: "No",
    rate: "2870.00"
  },
  {
    ino: "RA 22.3",
    description: "shifting meter to (seperate) location - single phase",
    unit: "No",
    rate: "2870.00"
  },
  {
    ino: "RA 22.4",
    description: "shifting meter to (seperate) location - three phase",
    unit: "No",
    rate: "4310.00"
  },
  {
    ino: "RA 23.1",
    description: "minor wayleaves ",
    unit: "No",
    rate: "3880.00"
  },
  {
    ino: "RA 3",
    description: "Excavation of pits for stays ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "Ra 3.1",
    description: "(For LT Stay) 4+0.5",
    unit: "No",
    rate: "3230.00"
  },
  {
    ino: "RA 4",
    description: "Dragging of poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 4.1",
    description: "8.3/9m wood pole- Flat ground",
    unit: "No",
    rate: "140.00"
  },
  {
    ino: "RA 4.2",
    description: "8.3/9m wood pole - Up slope",
    unit: "No",
    rate: "220.00"
  },
  {
    ino: "RA 4.3",
    description: "8.3/9m RC pole - Flat ground",
    unit: "No",
    rate: "430.00"
  },
  {
    ino: "RA 4.4",
    description: "8.3/9m RC pole - Up slope",
    unit: "No",
    rate: "790.00"
  },
  {
    ino: "RA 5",
    description: "Erection of poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 5.1",
    description: "Erection of poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 5.1.1",
    description: "6m Wooden poles",
    unit: "No",
    rate: "1650.00"
  },
  {
    ino: "RA 5.1.2",
    description: "6m RC Poles",
    unit: "NO",
    rate: "2230.00"
  },
  {
    ino: "RA 5.1.3",
    description: "3M Wooden Pole",
    unit: "NO",
    rate: "2870.00"
  },
  {
    ino: "RA 5.1.4",
    description: "8.3M RC - light weight & PS (all types ) pole",
    unit: "No",
    rate: "4740.00"
  },
  {
    ino: "RA 5.1.5",
    description: "8.3m 100kg/9m 200kg RC/Spun",
    unit: "No",
    rate: "5890.00"
  },
  {
    ino: "RA 5.1.6",
    description: "8.3m 500kg/9m  500kg PS/RC/Spun",
    unit: "No",
    rate: "7180.00"
  },
  {
    ino: "RA 5.1.7",
    description: "6m RC light weight & 6m PS spun concrete pole",
    unit: "No",
    rate: "2010.00"
  },
  {
    ino: "RA 5.2",
    description: "shifting of poles ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 5.2.1",
    description: "Shifting Of G.L Pipe 6m/7.6m Wood",
    unit: "No",
    rate: "6030.00"
  },
  {
    ino: "RA 5.2.2 ",
    description: "Shifting Of Pole 6m RC/Spun without dressing",
    unit: "No",
    rate: "7610.00"
  },
  {
    ino: "RA 5.2.3",
    description: "Shifting Of Pole 8.3m/9m Wood Pole",
    unit: "No",
    rate: "8690.00"
  },
  {
    ino: "RA 5.2.4",
    description: "Shifting Of Pole 8.3m/9m RC/Spun",
    unit: "No",
    rate: "10270.00"
  },
  {
    ino: "RA 5.3",
    description: "9m/8.3m wood pole 3.5+0.5",
    unit: "No",
    rate: "836.00"
  },
  {
    ino: "RA 5.4",
    description: "9m/8.3m Concrete pole 7.4 + 0.8",
    unit: "No",
    rate: "1713.00"
  },
  {
    ino: "RA 5.5",
    description: "9/350m Concrete pole 9+1",
    unit: "No",
    rate: "2090.00"
  },
  {
    ino: "RA 5.6",
    description: "9/500m Concrete pole 9+1",
    unit: "No",
    rate: "2090.00"
  },
  {
    ino: "RA 6",
    description: "Realignment of poles more than 10 deg angle slant",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 6.1",
    description: "8.3M,9M RC.PS & Wooden Poles",
    unit: "No",
    rate: "5740.00"
  },
  {
    ino: "RA 6.2",
    description: "6M/6.7M/7.6M RC,PS & Wooden Poles ",
    unit: "No",
    rate: "1800.00"
  },
  {
    ino: "RA 7",
    description: "Removal of  poles/struts",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 7.1",
    description: "8.3/9m wooden pole ",
    unit: "No",
    rate: "2580.00"
  },
  {
    ino: "RA 7.2",
    description: "6M/7.6M RC - light weight & spun pole ",
    unit: "No",
    rate: "3160.00"
  },
  {
    ino: "RA 7.3",
    description: "6m RC 50kg",
    unit: "No",
    rate: "3520.00"
  },
  {
    ino: "RA 7.4",
    description: "8.3m RC - light weight & spun pole",
    unit: "No",
    rate: "5740.00"
  },
  {
    ino: "RA 7.5",
    description: "8.3m/9m RC & PS Pole",
    unit: "No",
    rate: "7040.00"
  },
  {
    ino: "RA 8",
    description: "Removal of unusable poles/struts",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 8.1",
    description: "6m,8.3m,9m wooden,RC &PS poles/struts",
    unit: "No",
    rate: "1800.00"
  },
  {
    ino: "RA 8.2",
    description: "6m/6.7m Concrete pole",
    unit: "No",
    rate: "669.00"
  },
  {
    ino: "RA 8.3",
    description: "9m/8.3m wood pole 4+0.5",
    unit: "No",
    rate: "941.00"
  },
  {
    ino: "RA 8.4",
    description: "9m/8.3m Concrete pole 9+2",
    unit: "No",
    rate: "2299.00"
  },
  {
    ino: "RA 9",
    description: "Erection of stays",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RA 9.1",
    description: "Normal stay (LV stay) 4+0.5",
    unit: "No",
    rate: "941.00"
  },
  {
    ino: "RA 9.2",
    description: "Flying stay",
    unit: "No",
    rate: "1359.00"
  },
  {
    ino: "RA 9.3",
    description: "Repairing of LV stay",
    unit: "No",
    rate: "314.00"
  },
  {
    ino: "RA 9.4",
    description: "Retightening of LV stay",
    unit: "No",
    rate: "105.00"
  },
  {
    ino: "RA 9.5",
    description: "Relocating of LV stay",
    unit: "No",
    rate: "836.00"
  },
  {
    ino: "RB 1",
    description: "Excavation of pole pits",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 1.1",
    description: "2.5'x2'x5 1/2' (10-225 poles) 4.5 +1",
    unit: "No",
    rate: "1150.00"
  },
  {
    ino: "RB 1.2",
    description: "(11-350 poles) 6+1",
    unit: "No",
    rate: "1463.00"
  },
  {
    ino: "RB 1.3",
    description: "(11-500/ 11-850 poles) 9+1",
    unit: "No",
    rate: "2090.00"
  },
  {
    ino: "RB 1.4",
    description: "(11-1200 poles) 12+1",
    unit: "No",
    rate: "2717.00"
  },
  {
    ino: "RB 1.5",
    description: "(13-500 / 13-850 poles) 12+1",
    unit: "No",
    rate: "2717.00"
  },
  {
    ino: "RB 1.6",
    description: "(13-1200 poles) 18+1",
    unit: "No",
    rate: "3971.00"
  },
  {
    ino: "RB 2",
    description: "Dragging of poles ",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 2.1",
    description: "10m wood pole - Flat ground",
    unit: "No",
    rate: "63.00"
  },
  {
    ino: "RB 2.2",
    description: "10m wood pole - Up slope ",
    unit: "No",
    rate: "125.00"
  },
  {
    ino: "RB 2.3",
    description: "10m RC/PSS pole- Flat ground",
    unit: "No",
    rate: "125.00"
  },
  {
    ino: "RB 2.4",
    description: "10m RC/PSS pole - Up slope",
    unit: "No",
    rate: "251.00"
  },
  {
    ino: "RB 3 ",
    description: "Excavation of pits for struts",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 3.1",
    description: "(For 10-225 poles) 2.3 +0.5",
    unit: "No",
    rate: "585.00"
  },
  {
    ino: "RB 3.2",
    description: "(11-350 poles) 3+0.5",
    unit: "No",
    rate: "732.00"
  },
  {
    ino: "RB 4",
    description: "Excavation of pits for stays",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 4.1",
    description: "(For HT stay) 6+0.5",
    unit: "No",
    rate: "1359.00"
  },
  {
    ino: "RB 5",
    description: "Erection of poles",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 5.1",
    description: "10m wood pole 6+1",
    unit: "No",
    rate: "1463.00"
  },
  {
    ino: "RB 5.2",
    description: "10m concrete pole 9.7+1",
    unit: "No",
    rate: "2236.00"
  },
  {
    ino: "RB 5.3",
    description: "11-350 / 11-500 PS pole 4.5 + (13500/8)",
    unit: "No",
    rate: "2315.00"
  },
  {
    ino: "RB 5.4",
    description: "11-850/11-1200 PS pole 4.5+(13500/6)",
    unit: "No",
    rate: "3182.00"
  },
  {
    ino: "RB 5.5",
    description: "13-500 PS pole 6+(13500/4)",
    unit: "No",
    rate: "4420.00"
  },
  {
    ino: "RB 5.6",
    description: "13-850 PS pole 6+(13500/4)",
    unit: "No",
    rate: "4420.00"
  },
  {
    ino: "RB 5.6 4",
    description: "13-1200 PS pole 7 +(13500/4)",
    unit: "No",
    rate: "4420.00"
  },
  {
    ino: "RB 6",
    description: "Realignment of poles more than 10 deg angle slant.",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 6.1",
    description: "10m R.C or Wood poles 5.5 pit+2.5 ere=8",
    unit: "No",
    rate: "1672.00"
  },
  {
    ino: "RB 6.2",
    description: "11.350/11.500 R.C. poles 7 (135000/15)",
    unit: "No",
    rate: "2363.00"
  },
  {
    ino: "RB 7 ",
    description: "Concreting of pole pits",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.1",
    description: "10m concrete pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.1 a",
    description: "Charge for materials",
    unit: "No",
    rate: "5933.00"
  },
  {
    ino: "RB 7.1 b",
    description: "Labour charge for placing concrete 4.5+0.5",
    unit: "No",
    rate: "1045.00"
  },
  {
    ino: "RB 7.2",
    description: "11-350 PS pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.2 a",
    description: "Charge for materials ",
    unit: "No",
    rate: "6290.00"
  },
  {
    ino: "RB 7.2 b",
    description: "Labour charge for placing concrete 5+0.5",
    unit: "No",
    rate: "1150.00"
  },
  {
    ino: "RB 7.3",
    description: "11-500/11-850 PS pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.3 a",
    description: "Charge for materials",
    unit: "No",
    rate: "7595.00"
  },
  {
    ino: "RB 7.3 b",
    description: "Labour charge for placing concrete 5.5 +0.5",
    unit: "No",
    rate: "1254.00"
  },
  {
    ino: "RB 7.4",
    description: "11-1200 PS pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.4 a",
    description: "Charge for materials ",
    unit: "No",
    rate: "7595.00"
  },
  {
    ino: "RB 7.4 b",
    description: "Labour charge for placing concrete 6.5+0.5",
    unit: "No",
    rate: "1463.00"
  },
  {
    ino: "RB 7.5",
    description: "13-500 PS pole",
    unit: "No",
    rate: "0.00"
  },
  {
    ino: "RB 7.5 a",
    description: "Charge for materials",
    unit: "No",
    rate: "13525.00"
  },
  {
    ino: "RB 7.5 b",
    description: "Labour charge for placing concrete 6.5+.5",
    unit: "No",
    rate: "1463.00"
  },
  {
    ino: "ZA 1",
    description: "Test",
    unit: "No",
    rate: "100.00"
  }
],

        // localStorage keys
        storageKeys: {
            invoiceData: 'ceb_invoice_data',
            lineItems: 'ceb_line_items',
            lastSaved: 'ceb_last_saved'
        },

        init() {
            this.loadFromStorage();
            // Auto-save every 30 seconds
            setInterval(() => {
                this.saveToStorage();
            }, 30000);
            
            // Keyboard shortcut for saving (Ctrl+S)
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    this.saveInvoice();
                }
            });
        },

        // Save data to localStorage
        saveToStorage() {
            try {
                const dataToSave = {
                    invoiceData: this.invoiceData,
                    lineItems: this.lineItems,
                    timestamp: new Date().toISOString().split("T")[0]
                };
                
                localStorage.setItem(this.storageKeys.invoiceData, JSON.stringify(dataToSave));
                localStorage.setItem(this.storageKeys.lastSaved, new Date().toLocaleString());
                
                console.log('Invoice data saved to localStorage');
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        },

        // Show save notification
        displaySaveNotification() {
            this.showSaveNotification = true;
            setTimeout(() => {
                this.showSaveNotification = false;
            }, 2000);
        },

        // Load data from localStorage
        loadFromStorage() {
            try {
                const savedData = localStorage.getItem(this.storageKeys.invoiceData);
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    
                    if (parsedData.invoiceData) {
                        this.invoiceData = { ...this.invoiceData, ...parsedData.invoiceData };
                    }
                    
                    if (parsedData.lineItems && Array.isArray(parsedData.lineItems)) {
                        this.lineItems = parsedData.lineItems;
                    }
                    
                    console.log('Invoice data loaded from localStorage');
                }
            } catch (error) {
                console.error('Error loading from localStorage:', error);
            }
        },

        // Clear all saved data
        clearStorage() {
            try {
                localStorage.removeItem(this.storageKeys.invoiceData);
                localStorage.removeItem(this.storageKeys.lastSaved);
                console.log('All saved invoice data cleared');
            } catch (error) {
                console.error('Error clearing localStorage:', error);
            }
        },

        // Get last saved timestamp
        getLastSaved() {
            return localStorage.getItem(this.storageKeys.lastSaved) || 'Never';
        },

        get filteredSuggestions() {
            const suggestions = this.currentItem.ino ? 
                this.serviceDescriptions.filter(item => 
                    item.ino.toLowerCase().includes(this.currentItem.ino.toLowerCase()) ||
                    item.ino.toLowerCase().includes(this.currentItem.ino.toLowerCase())
                ) : [];
            console.log('Filtered suggestions:', suggestions, 'for input:', this.currentItem.ino);
            return suggestions;
        },

        get grandTotal() {
            return this.lineItems.reduce((total, item) => total + parseFloat(item.amount || 0), 0);
        },

        get printableRows() {
            const rows = [];
            const maxRows = 25;
            
            this.lineItems.forEach((item, index) => {
                rows.push({
                    sn: index + 1,
                    ino: item.ino,
                    description: item.description,
                    unit: item.unit,
                    rate: parseFloat(item.rate).toFixed(2),
                    quantity: parseFloat(item.quantity).toFixed(2),
                    amount: parseFloat(item.amount).toFixed(2),
                    // certifiedQty: parseFloat(item.quantity).toFixed(2),
                    // certifiedAmount: parseFloat(item.amount).toFixed(2)
                });
            });
            
            // Fill remaining rows with empty data
            if (this.lineItems.length < maxRows) {
                for (let i = this.lineItems.length; i < maxRows; i++) {
                    rows.push({
                        // sn: i + 1,
                        sn: "",
                        description: "",
                        unit: "",
                        rate: "",
                        quantity: "",
                        amount: "",
                        certifiedQty: "",
                        certifiedAmount: ""
                    });
                }
            }
            
            return rows;
        },

        selectSuggestion(suggestion) {
            this.currentItem.ino = suggestion.ino;
            this.currentItem.description = suggestion.description;
            this.currentItem.rate = suggestion.rate;
            this.currentItem.unit = suggestion.unit;
            this.showSuggestions = false;
            this.calculateAmount();
        },

        calculateAmount() {
            this.currentItem.amount = (this.currentItem.rate || 0) * (this.currentItem.quantity || 0);
        },

        canAddItem() {
            return this.currentItem.description && this.currentItem.rate >= 0 && this.currentItem.quantity >= 0;
        },

        addLineItem() {
            if (this.canAddItem()) {
                this.lineItems.push({
                    ino: this.currentItem.ino,
                    description: this.currentItem.description,
                    unit: this.currentItem.unit,
                    rate: this.currentItem.rate,
                    quantity: this.currentItem.quantity,
                    amount: this.currentItem.amount
                });
                
                this.currentItem = {
                    ino: "",
                    description: "",
                    unit: "Nos",
                    rate: 0,
                    quantity: 0,
                    amount: 0
                };
                
                // Save after adding item
                this.saveToStorage();
            }
        },

        removeLineItem(index) {
            if (confirm("üõë Are you sure you want to Delete " + " " + this.lineItems[index].ino + "?")) {
                this.lineItems.splice(index, 1);
                // Save after removing item
                this.saveToStorage();
            } else {
                console.log("Cancelled");
            }
        },

        formatDate(date) {
            if (!date) return "";
            const d = new Date(date);
            const year = d.getFullYear();
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        },

        printInvoice() {
            window.print();
        },

        // Save manually
        saveInvoice() {
            this.saveToStorage();
            this.displaySaveNotification();
        },

        // Load manually
        loadInvoice() {
            this.loadFromStorage();
            this.displaySaveNotification();
        },

        // Clear all data
        clearInvoice() {
            if (confirm('üõë Are you sure you want to delete this invoice data and start a new one?')) {
                                 this.invoiceData = {
                     contractorName: "",
                     location: "",
                     serviceNumber: "",
                     reportDate: (new Date).toISOString().split("T")[0],
                     officeName: "CSC - Matara"
                 };
                this.lineItems = [];
                this.currentItem = {
                    description: "",
                    unit: "Nos",
                    rate: 0,
                    quantity: 0,
                    amount: 0
                };
                this.clearStorage();
                this.displaySaveNotification();
            }
        }
    }
}
</script>


</body></html>